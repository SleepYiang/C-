## 操作系统与存储系统
### Linux Kernel
* **LRU**:
  > * 用于内存管理中的页面缓存，当物理内存不足的时候，系统会优先淘最近未使用的页面
  > * 内核的虚拟文件系统(VFS)也采用了LRU维护缓存的元数据



## 项目背景介绍
### 什么是缓存
&nbsp;&nbsp;&nbsp;&nbsp;系统将经常访问的数据暂存在内存中，加速数据访问的速度，降低延迟，提高吞吐率的利器。
### 为什么要实现缓存系统

- 通过牺牲一部分服务器内存，减少对磁盘或者数据库资源进行直接读写，换区更快的响应速度，负责存储经常访问的数据，通过设计合理的缓存机制提高访问效率
- 由于资源的有限，不可以把所有的数据存储在内存中，放内存超过一定的限制就需要通过滔天策略删除一些数据
### 在什么地方加缓存
缓存的顺序:用户请求->HTTP缓存->CDN缓存->代理服务器缓存->进程内缓存->分布式缓存->数据库存储,**距离用户越近，缓存能够发挥的效果越好**

## 缓存淘汰策略
> 缓存污染：访问缓存少的数据依然放在内存中，导致缓存资源的浪费
> 
> 缓存污染严重侯会因为加数据前需要清除之前的相关数据导致引入了额外的事件开销

### FIFO
先进先出算法，淘汰最早进入内存的页面，不论这些页面最后是否会被频繁访问。但是FIFO可能会导致Belady异常，分配给进程的物理块增加，缺页次数增加

### LRU
最近最少使用算法，如果一个数据最近访问的次数比较多那么将来的访问机率也比较大所以选择**最近常委时间没有访问的页面进行替换**，

潜在问题：一个长时间访问的数据在短时间内没有访问就会导致数据的替换
实现算法的过程中的难点在于要在O(1)的时间复杂度下完成get和put两个操作，所以好的数据结构至关重要LRUCache这个数据结构的必要条件：

1. LRUCache中的元素必须有时序。用来区分最近使用的数据和长久未使用的数据，数据满了淘汰长久未使用的，put操作将最近使用的元素加入LRUCache中
2. get操作需要将LRUCache中快速帝国为一个key值若存在则返回val，则需要保证该key元素在最近访问中

**具体的实现**

实现中需要的前置知识
> 1. **双链表的数据结构**

> 2. **什么是弱引用指针**
> - 弱引用指针主要是为了解决shared_ptr循环引用导致的相互持有的锁无法释放
> - weak_ptr无所有权：weak_ptr 不参与对象的引用计数管理，因此不会延长对象的生命周期。
> - 即使有 weak_ptr 指向对象，当最后一个 shared_ptr 销毁时，对象仍会被释放。
> - 依赖 shared_ptr：weak_ptr 无法直接创建，必须通过已有的 shared_ptr 初始化
> - 访问对象前需验证：由于 weak_ptr 指向的对象可能已被释放，使用前必须通过 lock() 方法获取 shared_ptr，间接访问对象。若对象已释放，lock() 返回空 shared_ptr。

> 3. **线程同步中互斥锁lock_guard的作用**
> - lock_guard是一种轻量锁可以自动加解锁
> - unique_lock独占锁额可以自动加锁解锁,也可以手动解锁

>  **两者的区别**
> - lock_guard是一个轻量的锁，主要用与保护核心代码（代码块的生命周期相同），中间不需要解锁操作
> - unique_lock是一个较重的锁，主要和条件变量配合使用，锁的所有权需要转换，需要延迟加锁，需要和条件变量配合使用 

> 4. 虚拟头尾的作用
> - 虚拟头尾的作用主要是为了设置一个守卫抱枕自己访问数据的时候不会越界
> 5. 类的继承

> 6. 纯虚函数

### 定时过期的LRU算法实现
相较于基本的LRU算法，需要先加插数据是否已经过期，未过期就重新设置时间，过期和不存在就返回-1(可以将该逻辑简化为不论当前缓存中是否讯在过期数据都将最久未使用的数据逐出)

记录当前过期时间节点需要引入time.h 头文件中的time_t，curTime获取当前时间后利用different函数比较节点过期时间和当前系统时间的大小

**具体实现**
> 1. 智能指针(unique_ptr shared_ptr)以及他们的创建方式
> 2. 

### 不定时过期的LRU算法实现
相较于基本的LRU算法先检查数据是否过期，数据存在重新插入过期时间不变 重新设置数据过期时间间隔ttl



### LFU算法实现
算法实现上:LFU任然需要哈希表双链表但是与LRU不同的是这个需要两个哈希表

- 哈希表1:用于快速的获取数据中的key对应的节点信息
- 哈希表2:为每一个访问频数构造一个双链表freqlist并且用哈希表联系两者的关系快速定位
